<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Methods | Fluid Responsiveness Prediction During Surgery – Physiological and Methodological Limitations and Considerations</title>
<meta name="author" content="Johannes Aagaard Enevoldsen">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="3 Methods | Fluid Responsiveness Prediction During Surgery – Physiological and Methodological Limitations and Considerations">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Methods | Fluid Responsiveness Prediction During Surgery – Physiological and Methodological Limitations and Considerations">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="templates/bs4_style.css">
<link rel="stylesheet" href="templates/corrections.css">
<meta name="description" content="This chapter introduces and discusses the methods used in the three Papers. In all three Papers, models have a central role; both as communicative tools and as specific statistical models (Papers...">
<meta property="og:description" content="This chapter introduces and discusses the methods used in the three Papers. In all three Papers, models have a central role; both as communicative tools and as specific statistical models (Papers...">
<meta name="twitter:description" content="This chapter introduces and discusses the methods used in the three Papers. In all three Papers, models have a central role; both as communicative tools and as specific statistical models (Papers...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""><p>Fluid Responsiveness Prediction During Surgery<br>
– Physiological and Methodological Limitations and Considerations</p></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="papers.html">Papers</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="background.html"><span class="header-section-number">2</span> Background</a></li>
<li><a class="active" href="methods.html"><span class="header-section-number">3</span> Methods</a></li>
<li><a class="" href="results-and-discussion.html"><span class="header-section-number">4</span> Results and discussion</a></li>
<li><a class="" href="conclusion-and-future-research.html"><span class="header-section-number">5</span> Conclusion and future research</a></li>
<li><a class="" href="references.html">References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="paper-1.html"><span class="header-section-number">A</span> Paper 1</a></li>
<li><a class="" href="paper-2.html"><span class="header-section-number">B</span> Paper 2</a></li>
<li><a class="" href="paper-3.html"><span class="header-section-number">C</span> Paper 3</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="methods" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Methods<a class="anchor" aria-label="anchor" href="#methods"><i class="fas fa-link"></i></a>
</h1>
<p>This chapter introduces and discusses the methods used in the three Papers. In all three Papers, <em>models</em> have a central role; both as communicative tools and as specific statistical models (Papers 2 and 3). Therefore, the first section is a general introduction to the scientific use of the term <em>model</em>.</p>
<div id="an-introduction-to-models" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> An introduction to <em>models</em><a class="anchor" aria-label="anchor" href="#an-introduction-to-models"><i class="fas fa-link"></i></a>
</h2>
<p>In science, <em>model</em> is often used as a synonym for both a statistical analysis, a simple representation of a complex system or a sophisticated computer simulation. However, the word’s exact meaning is often not specified, and has to be assumed from context. I will use this section to present the different meanings of the term <em>model</em>, focusing on those that are relevant for the present dissertation.</p>
<div id="a-model-can-be-a-mental-and-communicative-tool" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> A model can be a mental and communicative tool<a class="anchor" aria-label="anchor" href="#a-model-can-be-a-mental-and-communicative-tool"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the four effects of ventilation causing pulse pressure variation, illustrated in Figure <a href="background.html#fig:background-heart-lung-interactions">2.9</a>. To recap, in the right ventricle, inspiration lowers SV by limiting venous return and increasing afterload; in the left ventricle, inspiration increases pulmonary venous return by squeezing blood from the lungs and reduces afterload by increasing thoracic pressure relative to the remaining arterial pressure. Together these effects cause PPV. Of course, real physiology is more complex, but this simple <em>model</em> may aid a scientist in designing a study investigating the effect of e.g. PEEP on PPV, and it can give colleagues a common reference when discussing the interpretation of a high PPV in a patient with right ventricular failure. Without a common model, miscommunication will likely happen as each colleague has their own private mental model of the situation, and may assume that their peer’s mental model is identical.</p>
<p>This conceptual model of PPV is, however, not detailed enough, to enable quantitative predictions of what will happen to PPV, if we change ventilator settings; it is only a qualitative description of the relationship between ventilation and SV. To make quantitative predictions from a model, we need to mathematically define the relationship between the variables in the model.</p>
</div>
<div id="mathematical-models" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Mathematical models<a class="anchor" aria-label="anchor" href="#mathematical-models"><i class="fas fa-link"></i></a>
</h3>
<p>A mathematical model is a set of equations that, unambiguously, describes how a system behaves, often over time. The 2-compartment model of venous return (see Figure <a href="background.html#fig:background-venous-return-simple">2.4</a>) can be presented as a mathematical model. We can present equations defining how the compartments behave and how they are connected. The pressure in the compartments (right atrial and venous, but exemplified here with the right atrial compartment) is<br><span class="math display">\[
P_{RA} = \frac{V_{RA}}{C_{RA}},
\]</span>
where <span class="math inline">\(P\)</span> is pressure, <span class="math inline">\(V\)</span> is volume and <span class="math inline">\(C\)</span> is compliance. Venous return (<span class="math inline">\(Q_V\)</span>) is
<span class="math display">\[
Q_V = \frac{P_V - P_{RA}}{R_V},
\]</span>
where <span class="math inline">\(R_V\)</span> is resistance to venous return. The change in volume over time in each compartment is:
<span class="math display">\[
\dot{V}_V = CO - Q_{V}, \quad \dot{V}_{RA} = Q_{V} - CO.
\]</span>
To solve this set of differential equations, we define a constant CO (or a Frank-Starling-like cardiac function), a fixed compliance for each vascular compartment, a fixed <span class="math inline">\(R_V\)</span> and set the starting volumes for each vascular compartment (<span class="math inline">\(V_V\)</span> and <span class="math inline">\(V_{RA}\)</span>). We can now simulate how these volumes will evolve over time, and what their steady-state values will be.</p>
</div>
<div id="statistical-models" class="section level3" number="3.1.3">
<h3>
<span class="header-section-number">3.1.3</span> Statistical models<a class="anchor" aria-label="anchor" href="#statistical-models"><i class="fas fa-link"></i></a>
</h3>
<p>A statistical model is a specific type of mathematical model that uses random variation to explain the difference between the values expected from the model, and the values that are actually measured. In medical science, statistical models are usually extremely simplified representations of the actual (or assumed) causal relationship between variables.</p>
<p>For example, we may believe that <span class="math inline">\(V_T\)</span> affects PPV through a number of intermediate steps. But often, we are not interested in the intermediate effects—they may not even be identifiable from the data we have available. Instead we may assume that if we vary <span class="math inline">\(V_T\)</span> in a single individual, there is a linear relationship between <span class="math inline">\(V_T\)</span> and PPV:
<span class="math display">\[
PPV = \alpha + \beta V_T.
\]</span>
If we measure PPV repeatedly, and only change <span class="math inline">\(V_T\)</span> between measurements, we expect that PPV will vary according to the linear model above. Additionally, we also anticipate some variation in PPV that is not explained by the change in <span class="math inline">\(V_T\)</span>. This additional variation can be due to a physiological change over time, unrelated to the <span class="math inline">\(V_T\)</span> change, or due to imprecise measurements. Unexplained variation is traditionally represented by the greek letter <span class="math inline">\(\epsilon\)</span>, creating the statistical linear model:
<span class="math display">\[
PPV = \alpha + \beta V_T + \epsilon.
\]</span>
The statistical analysis of such a model quantifies how the independent variables (here <span class="math inline">\(V_T\)</span>) and random variation (<span class="math inline">\(\epsilon\)</span>) together explain the observed variation in the dependent variable (here PPV), and, importantly, how certain we are of each component’s contribution.</p>
</div>
</div>
<div id="paper-1-the-mini-fluid-challenge" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Paper 1 – The mini-fluid challenge<a class="anchor" aria-label="anchor" href="#paper-1-the-mini-fluid-challenge"><i class="fas fa-link"></i></a>
</h2>
<p>Paper 1 is a critique of the method used in most existing studies of the MFC as a predictor of fluid responsiveness. In this section, I will describe this common design and explain why it is problematic.</p>
<p>Most MFC studies <span class="citation">[<a href="references.html#ref-Muller2011" role="doc-biblioref">43</a>,<a href="references.html#ref-smorenbergMinifluidChallenge1502018" role="doc-biblioref">68</a>–<a href="references.html#ref-messinaMiniFluidChAllenge2021" role="doc-biblioref">75</a>]</span> use a design where SV, or a related variable, is measured thrice. First, a baseline measurement before any fluid is given; then, after the MFC (e.g. 100 ml) is given; and, lastly, after the remaining fluid (e.g. 400 ml) is given. The response to the MFC, here referred to as <span class="math inline">\(\Delta SV_{100}\)</span>, is then calculated as the relative change in SV from baseline to after the MFC. The outcome to predict, is the change from baseline to after the entire volume is given, here referred to as <span class="math inline">\(\Delta SV_{500}\)</span> (see Figure <a href="methods.html#fig:methods-mfc-common-design">3.1</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:methods-mfc-common-design"></span>
<img src="figures/methods-mfc-common-design.png" alt="The design used in most studies of the MFC." width="100%"><p class="caption">
Figure 3.1: The design used in most studies of the MFC.
</p>
</div>

<p>This design has two major problems. First, the response to the MFC is included in the outcome, that the MFC is supposed to predict. This creates a self-fulfilling prophecy: if the MFC response is high enough, the patient can have no response to the remaining fluid, and the conclusion will still be, that the MFC correctly predicted the full fluid response.</p>
<p>The second problem is more subtle. Measurements of SV are influenced by some random variation. This variation is caused by both measurement error and short-term physiological variation in SV. Both are essentially <em>noise</em> to the clinician, who wants to evaluate the response to a fluid challenge. The clinician is interested in the underlying, but unknowable average SV, not the short-term variation around this value. I will call this the “true” SV. If a measurement is, by chance, higher than the “true” SV, the next measurement will most likely show a decrease. Likewise, if a measurement is randomly low, the next will likely show be higher than the current. This phenomenon is called <em>regression towards the mean</em> (see Figure <a href="methods.html#fig:method-reg-to-the-mean">3.2</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-reg-to-the-mean"></span>
<img src="figures/method-reg-to-the-mean.png" alt="An illustration of regression towards the mean. An extreme SV measurement is likely followed by a measurement closer to the “true” (mean) SV." width="100%"><p class="caption">
Figure 3.2: An illustration of <em>regression towards the mean</em>. An extreme SV measurement is likely followed by a measurement closer to the “true” (mean) SV.
</p>
</div>

<p>In the common MFC study design, <span class="math inline">\(SV_{baseline}\)</span> is included in the calculation of both the predictor (<span class="math inline">\(\Delta SV_{100}\)</span>) and the outcome (<span class="math inline">\(\Delta SV_{500}\)</span>). Therefore, the random measurement error in <span class="math inline">\(SV_{baseline}\)</span> is included in both the predictor and the outcome, making them spuriously correlated <span class="citation">[<a href="references.html#ref-archieMathematicCouplingData1981" role="doc-biblioref">76</a>,<a href="references.html#ref-strattonRegressionCalculatedVariables1987" role="doc-biblioref">77</a>]</span>. In Figure <a href="methods.html#fig:method-mfc-null-sim">3.3</a>, this spurious correlation is illustrated with a simple computer simulation. It shows a simulated a MFC study, where all subjects have no response to fluid; only random variation in measured SV. A correct analysis should show that the MFC has no predictive ability—since there is nothing to predict—but it is clear that the change over the MFC (<span class="math inline">\(\Delta SV_{100}\)</span>) is correlated to the change over the full fluid administration (<span class="math inline">\(\Delta SV_{500}\)</span>) (see Figure <a href="methods.html#fig:method-mfc-null-sim">3.3</a>b).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-mfc-null-sim"></span>
<img src="figures/method-mfc-null-sim.png" alt="A simulated MFC study with 2000 subjects. Each subject has a constant “true” SV, and only random measurement variation around this value. a) A sample of data from 15 of the simulated subjects. b) Relationship between the MFC response and full fluid response. c) Relationship between MFC response and the response to the remaining fluid." width="100%"><p class="caption">
Figure 3.3: A simulated MFC study with 2000 subjects. Each subject has a constant “true” SV, and only random measurement variation around this value. <strong>a</strong>) A sample of data from 15 of the simulated subjects. <strong>b</strong>) Relationship between the MFC response and full fluid response. <strong>c</strong>) Relationship between MFC response and the response to the remaining fluid.
</p>
</div>

<p>The first problem, that the predictor is included in the outcome, can be fixed by predicting the response to only the remaining 400 ml (<span class="math inline">\(\Delta SV_{400}\)</span>). This, however, simply reverses the second problem, as the predictor and outcome now share the measurement error at <span class="math inline">\(SV_{100}\)</span>, creating an inverse spurious correlation (see Figure <a href="methods.html#fig:method-mfc-null-sim">3.3</a>c).</p>
<p>To illustrate the magnitude of the bias, we reanalysed data from the MFC study by Muller et al. <span class="citation">[<a href="references.html#ref-Muller2011" role="doc-biblioref">43</a>]</span>. Instead of showing the MFC’s ability to predict the full fluid response, we analysed the MFC’s ability to predict the response to the remaining 400 ml fluid. We did this by extracting data from Fig. 3A in Muller et al., 2011 <span class="citation">[<a href="references.html#ref-Muller2011" role="doc-biblioref">43</a>]</span>, and used the plotted <span class="math inline">\(\Delta SV_{100}\)</span> and <span class="math inline">\(\Delta SV_{500}\)</span> to calculate <span class="math inline">\(\Delta SV_{400}\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;In Muller’s study, the fluid response was evaluated with left-ventricular outflow tract velocity time integral (LVOT VTI, a Doppler ultrasonic measure correlated with SV). For simplicity, we simply refer to this as SV.&lt;/p&gt;"><sup>1</sup></a> As noted in the paragraph above, this approach is also biased, but now in the opposite direction.</p>
</div>
<div id="paper-2-generalized-additive-models" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Paper 2 – Generalized additive models<a class="anchor" aria-label="anchor" href="#paper-2-generalized-additive-models"><i class="fas fa-link"></i></a>
</h2>
<p>Paper 2 introduces generalized additive models (GAMs) as a tool for analysing medical time series and waveforms. The paper describes how GAMs can be used for robust estimation of PPV (a method used in Paper 3), and it presents a novel method for decomposing medical waveforms into simpler, repeating components.</p>
<div id="an-introduction-to-generalized-additive-models" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> An introduction to generalized additive models<a class="anchor" aria-label="anchor" href="#an-introduction-to-generalized-additive-models"><i class="fas fa-link"></i></a>
</h3>
<p>A GAM is an extension of the generalized linear model <span class="citation">[<a href="references.html#ref-hastieGeneralizedAdditiveModels1986" role="doc-biblioref">78</a>]</span>. For the purposes described here, we can, however, disregard the <em>generalized</em> part, and simply consider GAMs as multiple regression models that can fit smooth functions instead of only straight lines. These smooth functions are called regression splines (see Figure <a href="methods.html#fig:method-wood-spline">3.4</a>). Figure <a href="methods.html#fig:method-lm-vs-gam">3.5</a> illustrates how a linear model and a GAM fit the same simulated data.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-wood-spline"></span>
<img src="figures/method-wood-spline.png" alt="A regression spline is named after the wooden splines traditionally used by technical drawers for tracing smooth curves. (by Pearson Scott Foresman, public domain)." width="50%"><p class="caption">
Figure 3.4: A regression spline is named after the wooden splines traditionally used by technical drawers for tracing smooth curves. (by Pearson Scott Foresman, public domain).
</p>
</div>

<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-lm-vs-gam"></span>
<img src="figures/method-lm-vs-gam.png" alt="A linear model and a generalized additive model (GAM) fitting the same simulated data." width="100%"><p class="caption">
Figure 3.5: A linear model and a generalized additive model (GAM) fitting the same simulated data.
</p>
</div>

<p>In hemodynamic time series and waveforms, we often have patterns that repeat with each respiratory cycle or heart beat. When we fit such a repeating pattern with GAM, we can constrain the spline to start and end at the same value, slope and curvature (0th, 1st and 2nd derivative), to create a smoothly repeating curve (a cyclic spline). The function that generates the data in Figure <a href="methods.html#fig:method-lm-vs-gam">3.5</a> is <span class="math inline">\(Y = sin(X)\)</span>, so we know that it repeats itself at <span class="math inline">\(X = 2\pi = 6.28\)</span>. Figure <a href="methods.html#fig:method-gam-cyclic">3.6</a> illustrates the fit of the GAM with this additional, cyclic constraint.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-gam-cyclic"></span>
<img src="figures/method-gam-cyclic.png" alt="Illustration comparing a cyclic spline fit to the data-generating function (\(Y = sin(X)\) with added Gaussian noise)." width="100%"><p class="caption">
Figure 3.6: Illustration comparing a cyclic spline fit to the data-generating function (<span class="math inline">\(Y = sin(X)\)</span> with added Gaussian noise).
</p>
</div>

<p>The high flexibility of GAMs could also make them prone to overfitting data. This is countered by penalising the splines by their wiggliness (wiggliness is the inverse of smoothness).</p>
<p>A classic (unpenalised) least squares fit is found by minimising the loss function:
<span class="math display">\[
\sum_{i=1}^n (Y_i-\hat{Y}_i)^2,
\]</span>
where <span class="math inline">\(Y_i\)</span> are the observed values and <span class="math inline">\(\hat{Y}_i\)</span> are the values predicted by the model. For fitting penalised splines, a wiggliness penalty is added to the loss function:
<span class="math display">\[
\sum_{i=1}^n (Y_i-\hat{Y}_i)^2 + \lambda\int f''(X)^2 dX.
\]</span>
<span class="math inline">\(f''(X)\)</span> is the curvature of the spline (for a straight line, the curvature is 0). This is squared to keep it positive and then integrated over the range of the independent variable, <span class="math inline">\(X\)</span>. The smoothing parameter, <span class="math inline">\(\lambda\)</span>, is used to control the tradeoff between fitting data with minimal error and preferring a smooth spline less “prone” to overfitting <span class="citation">[<a href="references.html#ref-woodGeneralizedAdditiveModels2017" role="doc-biblioref">79</a>]</span>. It is possible, and often recommended, to automatically choose the smoothing parameter that optimise out-of-sample prediction (e.g. through cross-validation) <span class="citation">[<a href="references.html#ref-woodFastStableRestricted2011" role="doc-biblioref">80</a>]</span> (see Figure <a href="methods.html#fig:method-gam-wiggliness">3.7</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-gam-wiggliness"></span>
<img src="figures/method-gam-wiggliness.png" alt="In a penalised spline, the smoothing parameter, \(\lambda\), determines the tradeoff between fitting the data and creating a smooth line. \(lambda\) can be automatically chosen to minimise the risk of overfitting." width="100%"><p class="caption">
Figure 3.7: In a penalised spline, the smoothing parameter, <span class="math inline">\(\lambda\)</span>, determines the tradeoff between fitting the data and creating a smooth line. <span class="math inline">\(lambda\)</span> can be automatically chosen to minimise the risk of overfitting.
</p>
</div>

</div>
<div id="gam-ppv" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Estimating PPV using GAMs<a class="anchor" aria-label="anchor" href="#gam-ppv"><i class="fas fa-link"></i></a>
</h3>
<p>Using GAMs for estimating PPV was first proposed by Wyffels et al. <span class="citation">[<a href="references.html#ref-wyffelsNewAlgorithmQuantify2021" role="doc-biblioref">60</a>]</span>. They demonstrated how GAMs could be used to isolate the respiratory variation in PP in patients with atrial fibrillation, from the PPV caused by irregular beat-to-beat intervals. In Paper 2, we demonstrate how to use a simpler version of Wyffel’s model to estimate PPV from PP time series recorded on patients in sinus rhythm.</p>
<p>In sinus rhythm, the major source of PPV is respiratory variation in PP (as described in Section <a href="background.html#heart-lung-interaction-physiology">2.9</a>). We expect that there is some smooth relationship between <em>when in the respiratory cycle a heart beat occurs</em> and <em>the PP it produces</em>. We also expect that the PP produced by a beat in the end of a cycle is very similar to the PP produced by a beat in the beginning of a cycle; i.e., that the effect of the <em>position in the respiratory cycle</em> is cyclic. This cyclic respiratory variation in PP can be represented with the following GAM:
<span class="math display">\[
E(PP) = \alpha + f(pos_{\text{respiratory cycle}}),
\]</span>
where <span class="math inline">\(E(PP)\)</span> is the expected PP, <span class="math inline">\(\alpha\)</span> is the mean PP and <span class="math inline">\(f(pos_{\text{respiratory cycle}})\)</span> is the variation in PP around the mean, represented as a cyclic spline that goes from 0 (start of respiratory cycle) to 1 (end of respiratory cycle) and connects smoothly back to 0 (see Figure <a href="methods.html#fig:method-gam-PP">3.8</a>b).</p>
<p>In addition to the respiratory variation in PP, we also want the model to allow that PP can change slowly over time:
<span class="math display">\[
E(PP) = \alpha + f(pos_{\text{respiratory cycle}}) + f(time).
\]</span>
Now, <span class="math inline">\(E(PP)\)</span> is the sum of the repeating effect respiration and a smooth trend in PP over time (<span class="math inline">\(f(time)\)</span>) (see Figure <a href="methods.html#fig:method-gam-PP">3.8</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-gam-PP"></span>
<img src="figures/method-gam-PP.png" alt="Illustration of how a pulse pressure (PP) time series (a) can be modelled as a smooth repeating effect of ventilation (b) and a slow trend over time (c). Panel d shows the models prediction (fit): the sum of the mean PP, the effect of ventilation (b) and the trend over time (c)." width="100%"><p class="caption">
Figure 3.8: Illustration of how a pulse pressure (PP) time series (<strong>a</strong>) can be modelled as a smooth repeating effect of ventilation (<strong>b</strong>) and a slow trend over time (<strong>c</strong>). Panel <strong>d</strong> shows the models prediction (fit): the sum of the mean PP, the effect of ventilation (<strong>b</strong>) and the trend over time (<strong>c</strong>).
</p>
</div>

<p>From the fitted GAM, we can calculate PPV as the amplitude of the respiratory effect (Figure Figure <a href="methods.html#fig:method-gam-PP">3.8</a>b) divided by the mean PP (<span class="math inline">\(\alpha\)</span>):
<span class="math display">\[
PPV = 100\% \cdot \frac{ max(f(pos_{\text{respiratory cycle}})) - min(f(pos_{\text{respiratory cycle}})) }{\alpha}
\]</span></p>
</div>
<div id="decomposing-waveforms" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Decomposing waveforms<a class="anchor" aria-label="anchor" href="#decomposing-waveforms"><i class="fas fa-link"></i></a>
</h3>
<p>In the PP model above, we reduced the arterial blood pressure waveform to a time series of PP measurements before fitting the GAM. It is also possible to decompose a raw waveform. In addition to the effect of ventilation, we now also have a smooth effect that repeats with each heartbeat. Furthermore, these two effects may interact. In Paper 2, we exemplify this by decomposing a CVP waveform. The GAM has the following form:
<span class="math display">\[\begin{align*}
E(CVP) = &amp;\alpha + f(pos_{\text{cardiac cycle}}) + f(pos_{\text{respiratory cycle}}) \\
&amp;+ f(pos_{\text{cardiac cycle}}, pos_{\text{respiratory cycle}}) + f(time).
\end{align*}\]</span>
Here, <span class="math inline">\(f(pos_{\text{cardiac cycle}})\)</span> is similar to <span class="math inline">\(f(pos_{\text{respiratory cycle}})\)</span>, but repeats with every cardiac cycle (starting at the P-wave in the ECG). <span class="math inline">\(f(pos_{\text{cardiac cycle}}, pos_{\text{respiratory cycle}})\)</span> is a 2-dimensional smooth plane representing the effect of the interaction between the respiratory cycle and the cardiac cycle on CVP (see Figure <a href="methods.html#fig:method-gam-CVP">3.9</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-gam-CVP"></span>
<img src="figures/method-gam-CVP.png" alt="A central venous pressure (CVP) waveform (a) can be decomposed using a GAM into: b, a repeating effect for each heartbeat; c, a cyclic effect of ventilation; d, an interaction effect between the respiratory- and cardiac cycles; and, e, a slow trend over time (added to the mean CVP). Panel f shows the models prediction and the prediction error (residual): The prediction is the sum of the effects visualised in b to e." width="100%"><p class="caption">
Figure 3.9: A central venous pressure (CVP) waveform (<strong>a</strong>) can be decomposed using a GAM into: <strong>b</strong>, a repeating effect for each heartbeat; <strong>c</strong>, a cyclic effect of ventilation; <strong>d</strong>, an interaction effect between the respiratory- and cardiac cycles; and, <strong>e</strong>, a slow trend over time (added to the mean CVP). Panel <strong>f</strong> shows the models prediction and the prediction error (residual): The prediction is the sum of the effects visualised in <strong>b</strong> to <strong>e</strong>.
</p>
</div>

</div>
</div>
<div id="paper-3-effects-of-ventilator-settings-on-ppv" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Paper 3 – Effects of Ventilator Settings on PPV<a class="anchor" aria-label="anchor" href="#paper-3-effects-of-ventilator-settings-on-ppv"><i class="fas fa-link"></i></a>
</h2>
<p>Paper 3 investigates the effects of <span class="math inline">\(V_T\)</span> and RR on PPV, and how these ventilator setting affect PPV’s ability to predict the SV response to a fluid bolus. We expected that PPV at <span class="math inline">\(V_T\)</span>=10 ml kg<sup>-1</sup> and RR=10 min<sup>-1</sup> would predict fluid responsiveness with high accuracy, but that the accuracy would fall with lower <span class="math inline">\(V_T\)</span> and higher RR.</p>
<p>The study was approved by the regional ethics committee (January 2020, case 1-10-72-245-19) and registered on ClinicalTrials.gov (March 2020, NCT04298931). It was conducted at Aarhus University Hospital from May 2020 to June 2021. Patients gave written informed consent to participate.</p>
<p>Paper 3 presents a number of statistical methods including Bland-Altman analysis for method comparison, bootstrapped confidence intervals, mixed-effects models and Bayesian statistics. In this dissertation, I will only elaborate on Bayesian statistics and explain the Bayesian mixed-effects model presented in the paper.</p>
<div id="protocol" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Protocol<a class="anchor" aria-label="anchor" href="#protocol"><i class="fas fa-link"></i></a>
</h3>
<p>The experiment protocol was initiated after anaesthesia induction, in relation to a planned 250 ml fluid administration, where the patient was considered hemodynamically stable by the treating anesthesiologist. First, the patient was ventilated with ten different ventilator settings for 30 s each. Each setting was a unique combination of <span class="math inline">\(V_T\)</span> between 4 and 10 ml kg<sup>-1</sup> (predicted body weight <span class="citation">[<a href="references.html#ref-theacuterespiratorydistresssyndromenetworkVentilationLowerTidal2000" role="doc-biblioref">81</a>]</span>) and RR between 10 and 31 min<sup>-1</sup> (see Figure <a href="methods.html#fig:methods-vent-settings">3.10</a>). Then, a two-minute period was used to establish a baseline SV, after which a 250 fluid bolus was administered. If SV after the fluid administration was more than 10% higher than the baseline SV, the patient classified as a fluid responder.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:methods-vent-settings"></span>
<img src="figures/methods-vent-settings.png" alt="Example of the ventilation protocol. Dots represent combinations of \(V_T\) and RR. Settings were applied in numerical order. The order of RR=17, 24 and 31 min-1 were drawn at random for each subject. Curved lines represent settings that should result in equal alveolar ventilation, assuming a dead space volume of 1 ml kg-1." width="80%"><p class="caption">
Figure 3.10: Example of the ventilation protocol. Dots represent combinations of <span class="math inline">\(V_T\)</span> and RR. Settings were applied in numerical order. The order of RR=17, 24 and 31 min<sup>-1</sup> were drawn at random for each subject. Curved lines represent settings that should result in equal alveolar ventilation, assuming a dead space volume of 1 ml kg<sup>-1</sup>.
</p>
</div>

</div>
<div id="ppv-calculation" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> PPV calculation<a class="anchor" aria-label="anchor" href="#ppv-calculation"><i class="fas fa-link"></i></a>
</h3>
<p>PPV was calculated using two different methods:</p>
<p><span class="math inline">\(PPV_{Classic}\)</span> was calculated as described in the study introducing low HR/RR as a limitation to the reliability of PPV <span class="citation">[<a href="references.html#ref-michardClinicalUseRespiratory1999" role="doc-biblioref">53</a>,<a href="references.html#ref-Backer2009" role="doc-biblioref">57</a>]</span>:
<span class="math display">\[
PPV_{Classic} = \frac{PP_{max} - PP_{min}}{(PP_{max} + PP_{min})/2)},
\]</span>
averaged over three consecutive ventilation cycles.</p>
<p><span class="math inline">\(PPV_{GAM}\)</span> was calculated as described in Paper 2 (see Section <a href="methods.html#gam-ppv">3.3.2</a>).</p>
</div>
<div id="methods-co" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Stroke volume measurement using uncalibrated pulse contour analysis<a class="anchor" aria-label="anchor" href="#methods-co"><i class="fas fa-link"></i></a>
</h3>
<p>In Paper 3, we measured SV using the commercial FloTrac algorithm (fourth generation) built into the cardiac monitor (Hemosphere or EV1000, Edwards Lifesciences, Irvine, California) routinely used during major abominal surgery at Aarhus University Hospital. The FloTrac estimates beat-to-beat SV with a proprietary algorithm that analyses the arterial blood pressure waveform.</p>
<p>Since change in SV is used to determine a patient’s response to a fluid bolus, it is important that the FloTrac estimates SV correctly, and, especially, that changes in SV are measured correctly.</p>
<p>There are several methods for estimating SV or CO. The conversion between these is <span class="math inline">\(CO = SV \cdot HR\)</span>, and in the following, I will simply refer to all methods as estimating CO. The gold standard for CO measurement is debated, but is generally considered to be the <em>direct Fick principle</em> or <em>thermodilution</em> (CO<sub>TD</sub>) via a pulmonary artery catheter <span class="citation">[<a href="references.html#ref-kovacsOfficialEuropeanRespiratory2017" role="doc-biblioref">82</a>,<a href="references.html#ref-mckenzieReliabilityThermodilutionDerived2018" role="doc-biblioref">83</a>]</span>. Thermodilution is more common in clinical practice, and is usually the reference, when new methods for measuring CO are evaluated <span class="citation">[<a href="references.html#ref-joostenAccuracyPrecisionNoninvasive2017" role="doc-biblioref">84</a>,<a href="references.html#ref-montenijMethodologyMethodComparison2016" role="doc-biblioref">85</a>]</span>.</p>
<p>The first three generations of the FloTrac algorithm were evaluated in a systematic review of 65 studies <span class="citation">[<a href="references.html#ref-slagtSystematicReviewUncalibrated2014" role="doc-biblioref">86</a>]</span>. The overall <em>percentage error</em> was approx. 50%; a slightly simplified interpretation of this statistic is, that if a patient has a <em>true</em> CO of 5 L min<sup>-1</sup>, the difference between CO<sub>FloTrac</sub> and CO<sub>TD</sub> can be up to 2.5 L min<sup>-1</sup>. The fourth-generation FloTrac (used in Paper 3) aimed to improve performance, but of 6 studies comparing the fourth-generation FloTrac against CO<sub>TD</sub>, one showed a percentage error of 35% <span class="citation">[<a href="references.html#ref-geisenAccuracyPrecisionTrending2018" role="doc-biblioref">87</a>]</span> while the others had a percentage error of &gt;50% <span class="citation">[<a href="references.html#ref-heijneFourDifferentMethods2020" role="doc-biblioref">88</a>–<a href="references.html#ref-maedaAccuracyTrendingAbility2019" role="doc-biblioref">92</a>]</span>.</p>
<p>Even if CO<sub>FloTrac</sub> does not always agree with CO<sub>TD</sub>, they could agree on the changes in CO, if the difference between the devices is relatively constant within each patient. This agreement on CO changes (often denoted <em>trending ability</em>) is evaluated in most recent studies. These results are, unfortunately, not encouraging either; a 20% increase in CO<sub>TD</sub> may be accompanied by a fall in CO<sub>FloTrac</sub> or <em>vice versa</em> <span class="citation">[<a href="references.html#ref-geisenAccuracyPrecisionTrending2018" role="doc-biblioref">87</a>–<a href="references.html#ref-eisenriedAccuracyTrendingAbility2019" role="doc-biblioref">90</a>,<a href="references.html#ref-maedaAccuracyTrendingAbility2019" role="doc-biblioref">92</a>]</span>.</p>
<p>The performance of FloTrac may, however, be underestimated, since it is evaluated on its agreement with CO<sub>TD</sub>, which is likely imprecise itself <span class="citation">[<a href="references.html#ref-narangThermodilutionCardiacIndex2021" role="doc-biblioref">93</a>,<a href="references.html#ref-narangComparisonAccuracyEstimation2022" role="doc-biblioref">94</a>]</span>.</p>
</div>
<div id="bayesian-statistics" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Bayesian statistics<a class="anchor" aria-label="anchor" href="#bayesian-statistics"><i class="fas fa-link"></i></a>
</h3>
<p>The use of Bayesian statistics in Paper 3 is mainly due to the flexibility of Bayesian models, rather than a choice based on the Bayesian <em>vs</em> frequentist philosophy of statistics, or a wish to incorporate <em>prior</em> knowledge. Still, it is relevant to give a short, general introduction to Bayesian statistics, as many scientists have sparse familiarity with the topic.</p>
<p>Bayesian statistical models can be understood from a generative perspective: we define a model that we believe could generate data similar to what we have observed, if the model parameters are set appropriately. Finding the values for the model parameters, that makes the generated data most similar to the observed data, is called <em>fitting</em> the model. We define a model based on our <em>domain knowledge</em> about the relation between the predictor- and outcome variables, we specify our <em>prior</em> knowledge about the model parameters, and we provide some data we have observed. From these three components, the <em>model</em>, the <em>data</em> and the <em>priors</em>, we can answer the question: <em>If the data was generated by our proposed model, which sets of parameter values are compatible with the data we have observed?</em> <span class="citation">[<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">95</a>]</span>.</p>
<p>Bayesian updating provides the recipe for <em>fitting</em> the model, i.e. the act of turning <em>data</em> and <em>prior</em> knowledge about model parameters into <em>posterior</em> knowledge about model parameters (<em>prior</em> is before seeing the data, <em>posterior</em> is after seeing the data). This is formalised in Bayes theorem:
<span class="math display">\[
P(parameters|data) = \frac{P(data|parameters) P(parameters)}{P(data)},
\]</span>
where,</p>
<ul>
<li>
<span class="math inline">\(parameters\)</span> is a specific set of parameter values,</li>
<li>
<span class="math inline">\(P(parameters)\)</span> is the <em>prior</em>: our belief about how plausible the set of parameter values is without seeing the <em>data</em>,</li>
<li>
<span class="math inline">\(P(data|parameters)\)</span> is the <em>likelihood</em> distribution: how plausible the data we have observed is given the specific set of parameter values,</li>
<li>
<span class="math inline">\(P(data)\)</span> is the average probability of the data: essentially how likely the data is on average for the entire prior parameter distribution (this is a bit abstract, but it essentially ensures that the posterior distribution will sum to 1).</li>
<li>
<span class="math inline">\(P(parameters|data)\)</span> is the <em>posterior</em> distribution of the model parameters: the plausibility of the parameter values after seeing the data.</li>
</ul>
<div id="bayesian-updating-of-a-simple-model" class="section level4" number="3.4.4.1">
<h4>
<span class="header-section-number">3.4.4.1</span> Bayesian updating of a simple model<a class="anchor" aria-label="anchor" href="#bayesian-updating-of-a-simple-model"><i class="fas fa-link"></i></a>
</h4>
<p>To gain some intuition about how Bayesian updating works, we will go through fitting a very simple model. We sample subjects from a population and measure their heights. The aim is to estimate the mean and standard deviation (SD) of heights in the population from the heights in the sample.</p>
<p>First, we define a generative model, i.e., a model that—with the right parameter values—will generate data that looks like the data we have collected. In this example, the model is simple: we assume that each subjects is drawn from a normal (Gaussian) distribution with a mean, <span class="math inline">\(\mu\)</span>, and SD, <span class="math inline">\(\sigma\)</span>:
<span class="math display">\[
Height_i \sim Normal(\mu, \sigma),
\]</span>
where <span class="math inline">\(Height_i\)</span> is the height of subject <span class="math inline">\(i\)</span>. To complete the model, we add prior distributions for the two parameters, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>:
<span class="math display">\[\begin{align*}
\mu &amp;\sim Normal(170, 20) \\
\sigma &amp;\sim Uniform(1, 30).
\end{align*}\]</span>
The interpretation of this prior distribution is, that before we see any data, we are quite certain that the mean height in the population (<span class="math inline">\(\mu\)</span>) is somewhere between 130 and 210 cm (<span class="math inline">\(170 cm \pm 2 \cdot 20 cm\)</span>), and that the SD (<span class="math inline">\(\sigma\)</span>) is between 1 and 30 cm, with all values equally probable and values outside this range entirely impossible. These priors are only weakly informative and could be improved without much controversy, but here, their purpose is to illustrate how prior beliefs can be updated through observation of data.</p>
<p>Now, we systematically update our knowledge about the model parameters through observation of more and more data (heights). The top panel-pair in Figure <a href="methods.html#fig:method-bayes-update">3.11</a> displays our prior belief about the model parameters. When we start sampling heights from the population (black ticks in Figure <a href="methods.html#fig:method-bayes-update">3.11</a>), we update our beliefs about the parameter values, and the range of compatible parameter values become narrower. In this example, data is simulated, and we know that the <em>true</em> mean height (<span class="math inline">\(\mu\)</span>) is 165 cm and the <em>true</em> SD (<span class="math inline">\(\sigma\)</span>) is 10 cm.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-bayes-update"></span>
<img src="figures/method-bayes-update.png" alt="Illustration of how prior beliefs can be updated through observation of data. See main text for an explanation of the simulation. Orange lines are true parameter values. Shaded areas are 95% compatibility intervals. Black ticks are observations." width="100%"><p class="caption">
Figure 3.11: Illustration of how prior beliefs can be updated through observation of data. See main text for an explanation of the simulation. Orange lines are <em>true</em> parameter values. Shaded areas are 95% compatibility intervals. Black ticks are observations.
</p>
</div>

<p>In Figure <a href="methods.html#fig:method-bayes-update">3.11</a>, the distributions of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are visualised separately. They do, however, constitute a single, multidimensional, distribution, and in some models, parameter values can be highly correlated. Figure <a href="methods.html#fig:method-bayes-update-2d">3.12</a> visualise the two-dimensional distribution of the model parameters.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:method-bayes-update-2d"></span>
<img src="figures/method-bayes-update-2d.png" alt="The prior and posterior distributions are multidimensional distributions with a dimension for each parameter in the model. Color density represent probability density." width="100%"><p class="caption">
Figure 3.12: The prior and posterior distributions are multidimensional distributions with a dimension for each parameter in the model. Color density represent probability density.
</p>
</div>

<p>The shaded areas in Figure <a href="methods.html#fig:method-bayes-update">3.11</a> contain 95% of the probability mass for the parameter values. These are traditionally called 95% credible intervals, but I will use the alternative term <em>compatibility interval</em> (CI), as they can be interpreted as containing the parameter values that are compatible with the data we observe—this is also a reasonable interpretation of frequentist <em>confidence intervals</em> <span class="citation">[<a href="references.html#ref-gelmanAreConfidenceIntervals2019" role="doc-biblioref">96</a>]</span>.</p>
</div>
</div>
<div id="the-mixed-effects-model-in-paper-3" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> The mixed-effects model in Paper 3<a class="anchor" aria-label="anchor" href="#the-mixed-effects-model-in-paper-3"><i class="fas fa-link"></i></a>
</h3>
<p>A main aim in Paper 3 was to understand how <span class="math inline">\(V_T\)</span> and RR affect PPV. The experiment had a hierarchical structure, where PPV was measured repeatedly in each subject, with ten different RR and <span class="math inline">\(V_T\)</span> settings; we also calculated PPV with two different methods (PPV<sub>Classic</sub> and PPV<sub>GAM</sub>) and wanted to know if <span class="math inline">\(V_T\)</span> and RR impact PPV differently depending on the method. We used a Bayesian generalized mixed-effects model to find the effects of <span class="math inline">\(V_T\)</span>, RR and PPV-method on PPV. Below, I will walk through this model.</p>
<p>First, we specified a <em>likelihood function</em>. This specifies how likely different PPV values are given a mean, <span class="math inline">\(\mu\)</span>, and a variance parameter, <span class="math inline">\(\sigma\)</span>:
<span class="math display">\[
PPV_{strm} \sim StudentT(\mu_{strm},\sigma_{trm}, \text{df} = 4),
\]</span>
where <span class="math inline">\(PPV_{strm}\)</span> is PPV for subject <span class="math inline">\(s\)</span>, <span class="math inline">\(V_T\)</span> <span class="math inline">\(t\)</span>, RR <span class="math inline">\(r\)</span>, PPV-method <span class="math inline">\(m\)</span>. We used a Student’s T distribution with 4 degrees of freedom rather than a normal distribution, because it puts higher likelihood on extreme observations, and, therefore, is more robust to outliers.</p>
<p>We specified a linear model for <span class="math inline">\(\mu\)</span>, which, in this model, represents the expected PPV:
<span class="math display">\[
log(\mu_{strm}) =
\beta0_m +
\beta1_{tm} +
\beta2_{rm} +
\alpha_s.
\]</span>
Specifically, the linear model is for <span class="math inline">\(log(\mu)\)</span>. Therefore, the exponential of the parameters correspond to relative effects on PPV. <span class="math inline">\(exp(\beta1_{tm})\)</span> and <span class="math inline">\(exp(\beta2_{rm})\)</span> are the effects of each <span class="math inline">\(V_T\)</span>- and RR setting for each PPV method relative to the expected PPV at <span class="math inline">\(V_T\)</span>=10 ml kg<sup>-1</sup> and RR=10 min<sup>-1</sup>. <span class="math inline">\(exp(\beta0_m)\)</span> is the expected PPV at <span class="math inline">\(V_T\)</span>=10 ml kg<sup>-1</sup> and RR=10 min<sup>-1</sup> for each method. <span class="math inline">\(\alpha_s\)</span> is a random effect of each subject. It captures the between-individual variation in PPV.</p>
<p>The random effect, <span class="math inline">\(\alpha\)</span>, was estimated for each subject. We assumed that <span class="math inline">\(\alpha\)</span> for each subject is draw from a shared normal distribution with SD <span class="math inline">\(\sigma_{\alpha}\)</span>:
<span class="math display">\[
\alpha_s \sim Normal(0, \sigma_{\alpha})
\]</span>
This greatly reduces the degrees of freedom associated with estimating a parameter value for each subject. It also reduces the risk of overfitting, as the estimate of <span class="math inline">\(\alpha\)</span> for subjects with extreme values for PPV is shrunk towards the mean (an effect known as <em>partial pooling</em>) <span class="citation">[<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">95</a>]</span>.</p>
<p>The linear model for <span class="math inline">\(\sigma\)</span> is similar to the model for <span class="math inline">\(\mu\)</span>, but without the random effect:
<span class="math display">\[
log(\sigma_{trm}) =
\gamma0_{m} +
\gamma1_{tm} +
\gamma2_{rm}.
\]</span>
It allows the variance of the likelihood function to vary with ventilator setting and PPV-method.</p>
<p>Lastly, priors for all parameters are specified. These are all weakly informative (they allow all parameter values that are even remotely reasonable), and mainly serve to make the parameter estimation more efficient. Arguments for why these values are considered weakly informative are presented in Paper 3’s supplementary 1.
<span class="math display">\[\begin{align*}
&amp;\textbf{[Prior for SD of subjects]}\\
\sigma_\alpha \sim &amp;truncNormal(0, 1.5, trunc_{low} = 0) \\
%
&amp;\textbf{[Prior for PPVmethod-specific intercept]} \\
\beta0_{m} \sim &amp;Normal(2.3, 1)\text{, for PPVmethod m = (gam, classic)} \\
%
&amp;\textbf{[Prior for } \beta]\\
(\beta1_{tm},\beta2_{rm}) \sim &amp;Normal(0, 2), \\
&amp;\quad\text{for ventVT t = (8,6,4),} \\
&amp;\quad\text{ventRR r = (17,24,31),} \\
&amp;\quad\text{PPVmethod m = (gam, classic)} \\
% Sigma prior
&amp;\textbf{[Prior for } \gamma s \text{]} \\
(\gamma0_{m},\gamma1_{tm},\gamma2_{rm}) \sim &amp;Normal(0, 1.5), \\
&amp;\quad\text{for ventVT t = (8,6,4),} \\
&amp;\quad\text{ventRR r = (17,24,31),} \\
&amp;\quad\text{PPVmethod m = (gam, classic)}
\end{align*}\]</span></p>
</div>
<div id="sample-size" class="section level3" number="3.4.6">
<h3>
<span class="header-section-number">3.4.6</span> Sample size<a class="anchor" aria-label="anchor" href="#sample-size"><i class="fas fa-link"></i></a>
</h3>
<p>The sample size calculation was done with respect to fluid responsiveness prediction. We expected a fluid response in half the subjects and an AUROC of 0.8. To attain a power of 0.9 with <span class="math inline">\(\alpha\)</span> = 0.05, 33 patients should be included. To account for uncertainty in the proportion of fluid responders, and to obtain more precise estimates for the effect of ventilator settings on PPV, we planned to include 50 subjects.</p>


</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="background.html"><span class="header-section-number">2</span> Background</a></div>
<div class="next"><a href="results-and-discussion.html"><span class="header-section-number">4</span> Results and discussion</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#methods"><span class="header-section-number">3</span> Methods</a></li>
<li>
<a class="nav-link" href="#an-introduction-to-models"><span class="header-section-number">3.1</span> An introduction to models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#a-model-can-be-a-mental-and-communicative-tool"><span class="header-section-number">3.1.1</span> A model can be a mental and communicative tool</a></li>
<li><a class="nav-link" href="#mathematical-models"><span class="header-section-number">3.1.2</span> Mathematical models</a></li>
<li><a class="nav-link" href="#statistical-models"><span class="header-section-number">3.1.3</span> Statistical models</a></li>
</ul>
</li>
<li><a class="nav-link" href="#paper-1-the-mini-fluid-challenge"><span class="header-section-number">3.2</span> Paper 1 – The mini-fluid challenge</a></li>
<li>
<a class="nav-link" href="#paper-2-generalized-additive-models"><span class="header-section-number">3.3</span> Paper 2 – Generalized additive models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an-introduction-to-generalized-additive-models"><span class="header-section-number">3.3.1</span> An introduction to generalized additive models</a></li>
<li><a class="nav-link" href="#gam-ppv"><span class="header-section-number">3.3.2</span> Estimating PPV using GAMs</a></li>
<li><a class="nav-link" href="#decomposing-waveforms"><span class="header-section-number">3.3.3</span> Decomposing waveforms</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#paper-3-effects-of-ventilator-settings-on-ppv"><span class="header-section-number">3.4</span> Paper 3 – Effects of Ventilator Settings on PPV</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#protocol"><span class="header-section-number">3.4.1</span> Protocol</a></li>
<li><a class="nav-link" href="#ppv-calculation"><span class="header-section-number">3.4.2</span> PPV calculation</a></li>
<li><a class="nav-link" href="#methods-co"><span class="header-section-number">3.4.3</span> Stroke volume measurement using uncalibrated pulse contour analysis</a></li>
<li><a class="nav-link" href="#bayesian-statistics"><span class="header-section-number">3.4.4</span> Bayesian statistics</a></li>
<li><a class="nav-link" href="#the-mixed-effects-model-in-paper-3"><span class="header-section-number">3.4.5</span> The mixed-effects model in Paper 3</a></li>
<li><a class="nav-link" href="#sample-size"><span class="header-section-number">3.4.6</span> Sample size</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong><p>Fluid Responsiveness Prediction During Surgery<br>
– Physiological and Methodological Limitations and Considerations</p></strong>" was written by Johannes Aagaard Enevoldsen. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
